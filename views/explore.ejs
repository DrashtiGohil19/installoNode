<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon -->
    <link href="/assets/images/favicon.png" rel="icon" type="image/png">

    <title>Instello Sharing Photos</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Instello - Sharing Photos platform HTML Template">

    <!-- icons
            ================================================== -->
    <link rel="stylesheet" href="/assets/css/icons.css">

    <!-- CSS 
                ================================================== -->
    <link rel="stylesheet" href="/assets/css/uikit.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/tailwind.css">

    <!-- <link href="header.ejs"> -->
    <style>
        @media (min-width: 1024px) {
            .container {
                max-width: 950px !important;
                padding-top: 30px !important;
            }
        }
    </style>
</head>

<body>
    <%- include('header.ejs') %>
        <div class="main_content">

            <div class="container m-auto">

                <h1
                    class="lg:lg:text-2xl text-lg text-lg font-extrabold leading-none text-gray-900 tracking-tight mt-3">
                    Explore </h1>

                <div class="lg:m-0 -mx-5 flex justify-between items-center py-2 relative space-x-3 dark-tabs"
                    uk-sticky="cls-active: bg-gray-100 bg-opacity-95; media : @m ; media @m">
                    <div class="flex overflow-x-scroll lg:overflow-hidden lg:pl-0 pl-5 space-x-3 lg:py-2">
                        <a href="#" class="bg-white py-2 px-4 rounded inline-block font-bold shadow"> Shop</a>
                        <a href="#" class="bg-white py-2 px-4 rounded inline-block font-bold shadow"> Travel </a>
                        <a href="#" class="bg-white py-2 px-4 rounded inline-block font-bold shadow"> Fitness</a>
                        <a href="#" class="bg-white py-2 px-4 rounded inline-block font-bold shadow"> Technology</a>
                        <a href="#" class="bg-white py-2 px-4 rounded inline-block font-bold shadow"> Music </a>
                        <a href="#" class="bg-white py-2 px-4 rounded inline-block font-bold shadow"> Architecture</a>
                    </div>
                </div>

                <div class="grid lg:grid-cols-4 grid-cols-2 gap-2 hover:text-yellow-700 uk-link-reset">
                    <% all_post.forEach(function(item,index){ %>
                        <div>
                            <div
                                class="bg-red-400 max-w-full lg:h-64 h-4 rounded-md relative overflow-hidden uk-transition-toggle shadow-sm">
                                <a href="#story-modal<%= index %>" uk-toggle>
                                    <img src="/images/<%= item.image%>"
                                        class="w-full h-full absolute object-cover inset-0">
                                </a>
                                <div
                                    class="absolut absolute bottom-0 flex items-center justify-between px-4 py-3 space-x-2 text-white w-full custom-overly1">
                                    <a href="userprofile/<%= item.userId %>">
                                        <%= item.username%>
                                    </a>
                                    <div class="flex space-x-3">
                                        <a href="#" class="flex items-center"> <ion-icon name="heart"
                                                class="mr-1 md hydrated" role="img" aria-label="heart"></ion-icon>
                                            <%= item.totalLike %>
                                        </a>
                                        <a href="#" class="flex items-center"> <ion-icon name="chatbubble-ellipses"
                                                class="mr-1 md hydrated" role="img"
                                                aria-label="chatbubble ellipses"></ion-icon>
                                            <%= item.totalComment %>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <% }); %>
                </div>
            </div>

            <!-- Story modal -->
            <% all_post.forEach(function(item,index){ %>
                <div id="story-modal<%= index %>" class="uk-modal-container" uk-modal>
                    <div class="uk-modal-dialog story-modal">
                        <button
                            class="uk-modal-close-default lg:-mt-9 lg:-mr-9 -mt-5 -mr-5 shadow-lg bg-white rounded-full p-4 transition dark:bg-gray-600 dark:text-white"
                            type="button" uk-close></button>

                        <div class="story-modal-media">
                            <img src="images/<%= item.image %>" alt="" class="inset-0 h-full w-full object-cover"
                                style="height: 540px; width: 600px;"">
                        </div>
                        <div class=" flex-1 bg-white dark:bg-gray-900 dark:text-gray-100">

                            <!-- post header-->
                            <div class="border-b flex items-center justify-between px-5 py-3 dark:border-gray-600">
                                <div class=" flex flex-1 items-center space-x-4">
                                    <a href="#">
                                        <div class="bg-gradient-to-tr from-yellow-600 to-pink-600 p-0.5 rounded-full">
                                            <img src="images/<%= item.thumbnail %>"
                                                class="bg-gray-200 border border-white rounded-full w-8 h-8 object-cover">
                                        </div>
                                    </a>
                                    <span class="block text-lg font-semibold">
                                        <%= item.username %>
                                    </span>
                                </div>
                            </div>
                            <div class="story-content p-4" data-simplebar>

                                <p> Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh
                                    euismod
                                    tincidunt ut laoreet dolore magna aliquam erat volutpat. </p>

                                <div class="py-4 ">
                                    <div class="flex justify-around">
                                        <a href="like/<%= item.id %>" class="flex items-center space-x-3">
                                            <div class="flex font-bold items-baseline"> <i class="uil-heart mr-1"> </i>
                                                <%= item.totalLike %>
                                            </div>
                                        </a>
                                        <a href="/comment/<%= item.id %>" class="flex items-center space-x-3">
                                            <div class="flex font-bold items-baseline"> <i class="uil-comment mr-1"></i>
                                                <%= item.totalComment %>
                                            </div>
                                        </a>
                                        <a href="#" class="flex items-center space-x-3">
                                            <div class="flex font-bold items-baseline"> <i class="uil-heart mr-1"> </i>
                                                Share
                                            </div>
                                        </a>
                                    </div>
                                    <hr class="-mx-4 my-3">
                                    <a href="/postlike/<%= item.id %>">
                                        <div class="flex items-center space-x-3">
                                            <div class="flex items-center">
                                                <% likesData[item._id].forEach(like=> { %>
                                                    <img src="/images/<%= like.profile_pic %>" alt=""
                                                        class="w-6 h-6 rounded-full border-2 border-white dark:border-gray-900 -ml-2 object-cover">
                                                    <% }) %>
                                            </div>
                                            <div>
                                                Liked <strong><%= item.lastLike %></strong> and <strong> <%= item.totalLike - 1 %> Others </strong>
                                            </div>
                                        </div>
                                    </a>
                                </div>
                                <% postComments[item._id].forEach(comment=> { %>
                                    <div class="-mt-1 space-y-3">
                                        <div class="flex flex-1 items-center space-x-2">
                                            <a href="/userprofile/<%= comment.commentUserId %>">
                                                <img src="images/<%= comment.commentThumbnail %>"
                                                class="rounded-full w-8 h-8 object-cover">
                                            </a>
                                            <div class="flex-1 p-2">
                                                <%= comment.comment %>                            
                                            </div>
                                            
                                        </div>
                                    </div>
                                    <% }) %>

                            </div>

                            <!----------------- add comment --------------------->
                            <div class="p-3 border-t dark:border-gray-600">
                                <div class="bg-gray-200 dark:bg-gray-700 rounded-full rounded-md relative">
                                    <form action="/comment/<%= item.id %>" method="post">
                                        <input type="text" placeholder="Add your Comment.." name="comment"
                                            class="bg-transparent max-h-8 shadow-none">
                                        <div
                                            class="absolute bottom-0 flex h-full items-center right-0 right-3 text-xl space-x-2">
                                            <button type="submit">
                                                <p class="font-bold">Send</p>
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <%})%>
        </div>

        <script>

            (function (window, document, undefined) {
                'use strict';
                if (!('localStorage' in window)) return;
                var nightMode = localStorage.getItem('gmtNightMode');
                if (nightMode) {
                    document.documentElement.className += ' dark';
                }
            })(window, document);


            (function (window, document, undefined) {

                'use strict';

                // Feature test
                if (!('localStorage' in window)) return;

                // Get our newly insert toggle
                var nightMode = document.querySelector('#night-mode');
                if (!nightMode) return;

                // When clicked, toggle night mode on or off
                nightMode.addEventListener('click', function (event) {
                    event.preventDefault();
                    document.documentElement.classList.toggle('dark');
                    if (document.documentElement.classList.contains('dark')) {
                        localStorage.setItem('gmtNightMode', true);
                        return;
                    }
                    localStorage.removeItem('gmtNightMode');
                }, false);

            })(window, document);
        </script>

        <!-- Scripts
    ================================================== -->
        <script src="assets/js/tippy.all.min.js"></script>
        <script src="assets/js/jquery-3.3.1.min.js"></script>
        <script src="assets/js/uikit.js"></script>
        <script src="assets/js/simplebar.js"></script>
        <script src="assets/js/custom.js"></script>


        <script src="https://unpkg.com/ionicons@5.2.3/dist/ionicons.js"></script>
</body>

</html>